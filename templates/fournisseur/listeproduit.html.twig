{% extends 'base.html.twig' %}

{% block body %}




        <section class="col-md-8 liste">
            <h3>Liste des produits</h3>
            <div class="row justify-content-around align-items-start">
                <form method="get">
                    <label for="societe">Par Société :  </label>
                    <select name="societe" id="societe">
                        {% for societe in societes %}
                            <option name="societe" value="{{ societe.nom }}">{{ societe.nom }}</option>
                        {% endfor %}
                    </select>
                    <a class="btn btn-info" href="{{ path('app_index_listeproduit', {'societe': societeid}) }}"><button type="submit">OK</button></a>
                </form>
            </div>


            <table class="table table-bordered">
                <thead class="thead-dark">
                <tr>
                    <th class="text-center" scope="col">Nom</th>
                    <th class="text-center" scope="col">Catégorie</th>
                    <th class="text-center" scope="col">Prix</th>
                    <th class="text-center" scope="col">Unité</th>
                    <th class="text-center" scope="col">Promotion</th>
                    <th class="text-center" scope="col">Description</th>

                    <th class="text-center" scope="col"><span class="btn btn-info">-</span> / <span
                                class="btn btn-info">+</span></th>
                    <th class="text-center" scope="col">Annuler</th>

                </tr>
                </thead>
                <tbody>

                {% if nom is empty %}
                {% for produit in produits %}
                    {% if soc != produit.societe.nom %}
                        {% set soc=produit.societe.nom %}
                        <tr ><th colspan="8" class="table-success text-center">{{ soc }}</th></tr>
                    {% endif %}
                    <tr>
                        <th id="nom" class="text-center" scope="row">{{ produit.nom }}</th>
                        <td class="text-center">{{ produit.categorie }}</td>
                        <td id="prix" class="text-center">{{ produit.prix }}</td>
                        <td id="unite" class="text-center">{{ produit.unite }}</td>
                        <td class="text-center">{{ produit.promotion }}</td>
                        <td class="text-center">{{ produit.description }}</td>

                        <td class="text-center">
                            <a href="{{ path('app_index_panierremove', {'id': produit.id}) }}"><span id="remove"
                                                                                                     class="btn btn-info mr-1">-</span></a>


                            <input id="quantite" class="text-center" value="{% for item in items %}{% if item.produit.id == produit.id %}{{ item.quantite }}{% endif %}{% endfor %}" style="width: 15%;" type="text">


                            <a href="{{ path('app_index_panieradd', {'id': produit.id}) }}"><span id="add"
                                                                                                  class="ml-1 btn btn-info">+</span></a>
                        </td>
                        <td><a href="{{ path('app_index_panierdelete', {'id': produit.id}) }}"><span class="btn btn-danger">Annuler</span></a></td>

                    </tr>

                {% endfor %}
                {% else %}
                    {% for prod in prods %}
                        {% if soc != prod.societe.nom %}
                            {% set soc=prod.societe.nom %}
                            <tr ><th colspan="8" class="table-success text-center">{{ soc }}</th></tr>
                        {% endif %}


                <tr>
                    <th id="nom" class="text-center" scope="row">{{ prod.nom }}</th>
                    <td class="text-center">{{ prod.categorie }}</td>
                    <td id="prix" class="text-center">{{ prod.prix }}</td>
                    <td id="unite" class="text-center">{{ prod.unite }}</td>
                    <td class="text-center">{{ prod.promotion }}</td>
                    <td class="text-center">{{ prod.description }}</td>

                        <td class="text-center">

                            <a href="{{ path('app_index_panierremove', {'id': prod.id}) }}"><span id="remove"
                                                                                                     class="btn btn-info mr-1">-</span></a>


                            <input id="quantite" class="text-center" value="{% for item in items %}{% if item.produit.id == prod.id %}{{ item.quantite }}{% endif %}{% endfor %}" style="width: 15%;" type="text">


                            <a href="{{ path('app_index_panieradd', {'id': prod.id}) }}"><span id="add"
                                                                                                  class="ml-1 btn btn-info">+</span></a>
                        </td>

                        <td><a href="{{ path('app_index_panierdelete', {'id': prod.id}) }}"><span class="btn btn-danger">Annuler</span></a></td>

                </tr>

                {% endfor %}
                {% endif %}
                </tbody>
            </table>
        </section>

        <section style="min-height: 20vh" class="col-md-4 panier card">
            <h3>Commande</h3>

            <table>
                <tr>
                    <th>Nom</th>
                    <th>Quantité</th>
                    <th>Unité</th>
                    <th>Prix unité</th>
                    <th>Prix</th>
                </tr>
                {% for item in items %}
                    {% if soc != item.produit.societe.nom %}

                        {% set soc=item.produit.societe.nom %}
                        <tr ><th colspan="8" class="table-success text-center">{{ soc }}</th></tr>
                    {% endif %}
                    <tr>
                        <td>{{ item.produit.nom }}  </td>
                        <td>{{ item.quantite }}  </td>
                        <td>{{ item.produit.unite }}  </td>
                        <td>{{ item.produit.prix }} €  </td>
                        <td>{{ item.produit.prix * item.quantite }}  </td>
                    </tr>
                {% endfor %}
            </table>
            <div class="row" style="position: absolute;bottom: 5vh">
                <div class="col-md-8"><h5>Total de la commande : {{ total }} €</h5></div>
                <div class="col-md-4"><a href="{{ path('app_index_commande', {'id': app.user.societe.id}) }}"><button class="btn btn-success">Commander</button></a></div>
            </div>
        </section>



{% endblock body %}