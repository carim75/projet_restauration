{% extends 'base.html.twig' %}

{% block body %}

    <main class="main">
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link " href="{{ path('app_index_homepage') }}">Accueil</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{{ path('app_index_livraison') }}">Livraison</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="{{ path('app_index_listecommande') }}">Commandes</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{{ path('app_index_listeproduit') }}">Liste des produits</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{{ path('app_index_editproduit') }}">Ajout/Suppression de produit</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{{ path('app_index_promos') }}">Promotions</a>
            </li>
        </ul>

            

        <h1>Commandes</h1>
        <table class="table table-bordered">
            <thead class="thead-dark">
            <tr>
                <th class="text-center" scope="col">Nom</th>
                <th class="text-center" scope="col">Prix</th>
                <th class="text-center" scope="col">Quantité</th>
                <th class="text-center" scope="col">Unité</th>
                <th class="text-center" scope="col">Total</th>
            </tr>
            </thead>
            <tbody>

            {% for societe in societes %}
            {% for commande in commandes %}
                {% for achat in achats %}
                    {% if achat.commande.id == commande.id and achat.produit.societe.id == societe.id %}
                        {% if soc != achat.produit.societe.nom %}
                          {% set soc=achat.produit.societe.nom %}
                            <tr ><th colspan="5" class="table-success text-center">{{ soc }}</th></tr>
                        {% endif %}

                        <tr>
                            <td class="text-center">{{ achat.produit.nom }}</td>
                            <td class="text-center">{{ achat.prix }} €</td>
                            <td class="text-center">{{ achat.quantite }}</td>
                            <td class="text-center">{{ achat.produit.unite }}</td>
                            <td class="text-center">{{ achat.prix * achat.quantite }}</td>
                        </tr>
                    {% endif %}

                {% endfor %}
            {% endfor %}
            {% endfor %}
            </tbody>
            <tfoot>
            <tr>
                <td class="text-right" colspan="3">Total de la commande :</td>
                <td class="text-center"> €</td>
            </tr>
            </tfoot>
        </table>
        {% if app.user.fonction == 'Restaurateur' %}
                <form action="" method="post">
                    <label for="date_livraison">Date livraison</label>
                    <input type="text">
                    <button class="btn btn-primary">Valider la commande</button>
                </form>
        {% endif %}

    </main>
{% endblock %}